# OPC UA Checklist

此列表为了帮助工程师收集所有重要信息，并确保迅速处理问题。

| 序号 | 内容                                                         | 结果 |
| ---- | ------------------------------------------------------------ | ---- |
| 1    | 详细的错误描述信息（可从Logger与功能块中获取）               |      |
| 2    | B&R PLC 作为server 还是 client?                              |      |
| 3    | UA Server / AsOpcUac / AsOpcUas / OpcUaAny / MappView client 报错? |      |
| 4    | OPC UA 错误码?                                               |      |
| 5    | Automation Runtime 版本 / MappView 版本?                     |      |

## 如果使用了第三方Client / Server

| 序号 | 内容                                                         | 结果 |
| ---- | ------------------------------------------------------------ | ---- |
| 1    | Wireshark Trace 未加密连接的，必须使用HUB或在服务器/客户端设备上直接Trace。 |      |
| 2    | 第三方 client / server 信息                                  |      |

## 如果是证书问题

| 序号 | 内容                                           | 结果 |
| ---- | ---------------------------------------------- | ---- |
| 1    | 服务器和客户端的日期和时间正确                 |      |
| 2    | 服务器/客户端在可信列表中拥有证书链的所有证书? |      |

## 如果是内存问题

| 序号 | 内容                                                         | 结果 |
| ---- | ------------------------------------------------------------ | ---- |
| 1    | 随着时间的推移检查服务器/客户端上的空闲DRAM ( 内存泄漏x字节 / 小时 ) |      |

# OPC UA Wireshark trace

按以下步骤生成Wireshark trace

-   如果Wireshark不在 OPC UA Server或Client PC上运行，Wireshark Trace必须在Server和Clinet之间的Hub上采集(而不是基于网络交换机)
-   确保记录未加密的通信连接，因为在没有解密密钥的情况下不可能恢复协议信息
-   使用捕获筛选器抓包：TCP协议 端口 4840 (注意: 使用服务器端上实际配置的端口)
-   停止捕获，然后保存为Wireshark pcapng，并将“Compress with gzip”设置为true。

